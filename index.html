<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>deep_dive</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="sharing">
<meta property="og:type" content="website">
<meta property="og:title" content="deep_dive">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="deep_dive">
<meta property="og:description" content="sharing">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="deep_dive">
<meta name="twitter:description" content="sharing">
  
    <link rel="alternate" href="/atom.xml" title="deep_dive" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">deep_dive</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">gone with the wind</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-反向传播算法原理及代码样例" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/17/反向传播算法原理及代码样例/" class="article-date">
  <time datetime="2019-08-17T07:55:29.000Z" itemprop="datePublished">2019-08-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/17/反向传播算法原理及代码样例/">反向传播算法原理及代码样例</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p>此处省略balabala个字，只展示一个三层BP的实例代码（Python<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import random</span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">#   参数解释：</span><br><span class="line">#   &quot;pd_&quot; ：偏导的前缀</span><br><span class="line">#   &quot;d_&quot; ：导数的前缀</span><br><span class="line">#   &quot;w_ho&quot; ：隐含层到输出层的权重系数索引</span><br><span class="line">#   &quot;w_ih&quot; ：输入层到隐含层的权重系数的索引</span><br><span class="line"></span><br><span class="line">class NeuralNetwork:</span><br><span class="line">    LEARNING_RATE = 0.5</span><br><span class="line"></span><br><span class="line">    def __init__(self, num_inputs, num_hidden, num_outputs, hidden_layer_weights = None, hidden_layer_bias = None, output_layer_weights = None, output_layer_bias = None):</span><br><span class="line">        self.num_inputs = num_inputs</span><br><span class="line"></span><br><span class="line">        self.hidden_layer = NeuronLayer(num_hidden, hidden_layer_bias)</span><br><span class="line">        self.output_layer = NeuronLayer(num_outputs, output_layer_bias)</span><br><span class="line"></span><br><span class="line">        self.init_weights_from_inputs_to_hidden_layer_neurons(hidden_layer_weights)</span><br><span class="line">        self.init_weights_from_hidden_layer_neurons_to_output_layer_neurons(output_layer_weights)</span><br><span class="line"></span><br><span class="line">    def init_weights_from_inputs_to_hidden_layer_neurons(self, hidden_layer_weights):</span><br><span class="line">        weight_num = 0</span><br><span class="line">        for h in range(len(self.hidden_layer.neurons)):</span><br><span class="line">            for i in range(self.num_inputs):</span><br><span class="line">                if not hidden_layer_weights:</span><br><span class="line">                    self.hidden_layer.neurons[h].weights.append(random.random())</span><br><span class="line">                else:</span><br><span class="line">                    self.hidden_layer.neurons[h].weights.append(hidden_layer_weights[weight_num])</span><br><span class="line">                weight_num += 1</span><br><span class="line"></span><br><span class="line">    def init_weights_from_hidden_layer_neurons_to_output_layer_neurons(self, output_layer_weights):</span><br><span class="line">        weight_num = 0</span><br><span class="line">        for o in range(len(self.output_layer.neurons)):</span><br><span class="line">            for h in range(len(self.hidden_layer.neurons)):</span><br><span class="line">                if not output_layer_weights:</span><br><span class="line">                    self.output_layer.neurons[o].weights.append(random.random())</span><br><span class="line">                else:</span><br><span class="line">                    self.output_layer.neurons[o].weights.append(output_layer_weights[weight_num])</span><br><span class="line">                weight_num += 1</span><br><span class="line"></span><br><span class="line">    def inspect(self):</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line">        print(&apos;* Inputs: &#123;&#125;&apos;.format(self.num_inputs))</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line">        print(&apos;Hidden Layer&apos;)</span><br><span class="line">        self.hidden_layer.inspect()</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line">        print(&apos;* Output Layer&apos;)</span><br><span class="line">        self.output_layer.inspect()</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line"></span><br><span class="line">    def feed_forward(self, inputs):</span><br><span class="line">        hidden_layer_outputs = self.hidden_layer.feed_forward(inputs)</span><br><span class="line">        return self.output_layer.feed_forward(hidden_layer_outputs)</span><br><span class="line"></span><br><span class="line">    def train(self, training_inputs, training_outputs):</span><br><span class="line">        self.feed_forward(training_inputs)</span><br><span class="line"></span><br><span class="line">        # 1. 输出神经元的值</span><br><span class="line">        pd_errors_wrt_output_neuron_total_net_input = [0] * len(self.output_layer.neurons)</span><br><span class="line">        for o in range(len(self.output_layer.neurons)):</span><br><span class="line"></span><br><span class="line">            # ∂E/∂zⱼ</span><br><span class="line">            pd_errors_wrt_output_neuron_total_net_input[o] = self.output_layer.neurons[o].calculate_pd_error_wrt_total_net_input(training_outputs[o])</span><br><span class="line"></span><br><span class="line">        # 2. 隐含层神经元的值</span><br><span class="line">        pd_errors_wrt_hidden_neuron_total_net_input = [0] * len(self.hidden_layer.neurons)</span><br><span class="line">        for h in range(len(self.hidden_layer.neurons)):</span><br><span class="line"></span><br><span class="line">            # dE/dyⱼ = Σ ∂E/∂zⱼ * ∂z/∂yⱼ = Σ ∂E/∂zⱼ * wᵢⱼ</span><br><span class="line">            d_error_wrt_hidden_neuron_output = 0</span><br><span class="line">            for o in range(len(self.output_layer.neurons)):</span><br><span class="line">                d_error_wrt_hidden_neuron_output += pd_errors_wrt_output_neuron_total_net_input[o] * self.output_layer.neurons[o].weights[h]</span><br><span class="line"></span><br><span class="line">            # ∂E/∂zⱼ = dE/dyⱼ * ∂zⱼ/∂</span><br><span class="line">            pd_errors_wrt_hidden_neuron_total_net_input[h] = d_error_wrt_hidden_neuron_output * self.hidden_layer.neurons[h].calculate_pd_total_net_input_wrt_input()</span><br><span class="line"></span><br><span class="line">        # 3. 更新输出层权重系数</span><br><span class="line">        for o in range(len(self.output_layer.neurons)):</span><br><span class="line">            for w_ho in range(len(self.output_layer.neurons[o].weights)):</span><br><span class="line"></span><br><span class="line">                # ∂Eⱼ/∂wᵢⱼ = ∂E/∂zⱼ * ∂zⱼ/∂wᵢⱼ</span><br><span class="line">                pd_error_wrt_weight = pd_errors_wrt_output_neuron_total_net_input[o] * self.output_layer.neurons[o].calculate_pd_total_net_input_wrt_weight(w_ho)</span><br><span class="line"></span><br><span class="line">                # Δw = α * ∂Eⱼ/∂wᵢ</span><br><span class="line">                self.output_layer.neurons[o].weights[w_ho] -= self.LEARNING_RATE * pd_error_wrt_weight</span><br><span class="line"></span><br><span class="line">        # 4. 更新隐含层的权重系数</span><br><span class="line">        for h in range(len(self.hidden_layer.neurons)):</span><br><span class="line">            for w_ih in range(len(self.hidden_layer.neurons[h].weights)):</span><br><span class="line"></span><br><span class="line">                # ∂Eⱼ/∂wᵢ = ∂E/∂zⱼ * ∂zⱼ/∂wᵢ</span><br><span class="line">                pd_error_wrt_weight = pd_errors_wrt_hidden_neuron_total_net_input[h] * self.hidden_layer.neurons[h].calculate_pd_total_net_input_wrt_weight(w_ih)</span><br><span class="line"></span><br><span class="line">                # Δw = α * ∂Eⱼ/∂wᵢ</span><br><span class="line">                self.hidden_layer.neurons[h].weights[w_ih] -= self.LEARNING_RATE * pd_error_wrt_weight</span><br><span class="line"></span><br><span class="line">    def calculate_total_error(self, training_sets):</span><br><span class="line">        total_error = 0</span><br><span class="line">        for t in range(len(training_sets)):</span><br><span class="line">            training_inputs, training_outputs = training_sets[t]</span><br><span class="line">            self.feed_forward(training_inputs)</span><br><span class="line">            for o in range(len(training_outputs)):</span><br><span class="line">                total_error += self.output_layer.neurons[o].calculate_error(training_outputs[o])</span><br><span class="line">        return total_error</span><br><span class="line"></span><br><span class="line">class NeuronLayer:</span><br><span class="line">    def __init__(self, num_neurons, bias):</span><br><span class="line"></span><br><span class="line">        # 同一层的神经元共享一个截距项b</span><br><span class="line">        self.bias = bias if bias else random.random()</span><br><span class="line"></span><br><span class="line">        self.neurons = []</span><br><span class="line">        for i in range(num_neurons):</span><br><span class="line">            self.neurons.append(Neuron(self.bias))</span><br><span class="line"></span><br><span class="line">    def inspect(self):</span><br><span class="line">        print(&apos;Neurons:&apos;, len(self.neurons))</span><br><span class="line">        for n in range(len(self.neurons)):</span><br><span class="line">            print(&apos; Neuron&apos;, n)</span><br><span class="line">            for w in range(len(self.neurons[n].weights)):</span><br><span class="line">                print(&apos;  Weight:&apos;, self.neurons[n].weights[w])</span><br><span class="line">            print(&apos;  Bias:&apos;, self.bias)</span><br><span class="line"></span><br><span class="line">    def feed_forward(self, inputs):</span><br><span class="line">        outputs = []</span><br><span class="line">        for neuron in self.neurons:</span><br><span class="line">            outputs.append(neuron.calculate_output(inputs))</span><br><span class="line">        return outputs</span><br><span class="line"></span><br><span class="line">    def get_outputs(self):</span><br><span class="line">        outputs = []</span><br><span class="line">        for neuron in self.neurons:</span><br><span class="line">            outputs.append(neuron.output)</span><br><span class="line">        return outputs</span><br><span class="line"></span><br><span class="line">class Neuron:</span><br><span class="line">    def __init__(self, bias):</span><br><span class="line">        self.bias = bias</span><br><span class="line">        self.weights = []</span><br><span class="line"></span><br><span class="line">    def calculate_output(self, inputs):</span><br><span class="line">        self.inputs = inputs</span><br><span class="line">        self.output = self.squash(self.calculate_total_net_input())</span><br><span class="line">        return self.output</span><br><span class="line"></span><br><span class="line">    def calculate_total_net_input(self):</span><br><span class="line">        total = 0</span><br><span class="line">        for i in range(len(self.inputs)):</span><br><span class="line">            total += self.inputs[i] * self.weights[i]</span><br><span class="line">        return total + self.bias</span><br><span class="line"></span><br><span class="line">    # 激活函数sigmoid</span><br><span class="line">    def squash(self, total_net_input):</span><br><span class="line">        return 1 / (1 + math.exp(-total_net_input))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def calculate_pd_error_wrt_total_net_input(self, target_output):</span><br><span class="line">        return self.calculate_pd_error_wrt_output(target_output) * self.calculate_pd_total_net_input_wrt_input();</span><br><span class="line"></span><br><span class="line">    # 每一个神经元的误差是由平方差公式计算的</span><br><span class="line">    def calculate_error(self, target_output):</span><br><span class="line">        return 0.5 * (target_output - self.output) ** 2</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    def calculate_pd_error_wrt_output(self, target_output):</span><br><span class="line">        return -(target_output - self.output)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    def calculate_pd_total_net_input_wrt_input(self):</span><br><span class="line">        return self.output * (1 - self.output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def calculate_pd_total_net_input_wrt_weight(self, index):</span><br><span class="line">        return self.inputs[index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 一个实例:</span><br><span class="line"></span><br><span class="line">nn = NeuralNetwork(2, 2, 2, hidden_layer_weights=[0.15, 0.2, 0.25, 0.3], hidden_layer_bias=0.35, output_layer_weights=[0.4, 0.45, 0.5, 0.55], output_layer_bias=0.6)</span><br><span class="line">for i in range(10000):</span><br><span class="line">    nn.train([0.05, 0.1], [0.01, 0.09])</span><br><span class="line">    print(i, round(nn.calculate_total_error([[[0.05, 0.1], [0.01, 0.09]]]), 9))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#另外一个例子，可以把上面的例子注释掉再运行一下:</span><br><span class="line"></span><br><span class="line"># training_sets = [</span><br><span class="line">#     [[0, 0], [0]],</span><br><span class="line">#     [[0, 1], [1]],</span><br><span class="line">#     [[1, 0], [1]],</span><br><span class="line">#     [[1, 1], [0]]</span><br><span class="line"># ]</span><br><span class="line"></span><br><span class="line"># nn = NeuralNetwork(len(training_sets[0][0]), 5, len(training_sets[0][1]))</span><br><span class="line"># for i in range(10000):</span><br><span class="line">#     training_inputs, training_outputs = random.choice(training_sets)</span><br><span class="line">#     nn.train(training_inputs, training_outputs)</span><br><span class="line">#     print(i, nn.calculate_total_error(training_sets))</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/17/反向传播算法原理及代码样例/" data-id="cjzf95x8h00019kvqv24691zu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-数字图像色彩分层提取" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/09/数字图像色彩分层提取/" class="article-date">
  <time datetime="2019-08-09T06:32:57.000Z" itemprop="datePublished">2019-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/09/数字图像色彩分层提取/">数字图像提取</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/09/数字图像色彩分层提取/" data-id="cjzf95x8j00029kvqop9s3mbs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-数字图像边缘检测" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/07/数字图像边缘检测/" class="article-date">
  <time datetime="2019-08-07T00:51:06.000Z" itemprop="datePublished">2019-08-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/07/数字图像边缘检测/">图像识别（会步步深入，计划是完成人脸识别朝向，再之后可能会做复杂一点的人脸识别问题，会动态更新</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="数字图像边缘检测的原理及方法"><a href="#数字图像边缘检测的原理及方法" class="headerlink" title="数字图像边缘检测的原理及方法"></a>数字图像边缘检测的原理及方法</h2><p>边缘是要提取目标与背景的边界线，只有检测出边缘信息才能把目标从背景中分离出来，并用于目标区域的识别、图像分割和图像滤波等，通过对边缘信息的检测可以最大程度地减少图像分析处理过程中的巨大数据量。图像中的边缘检测主要针对图像灰度变化的度量检测和定位，就是检测图像特性变化的位置，边缘的描述包含以下几个方面。<br>1.边缘的法线方向：在某点灰度变化最剧烈的方向，与边缘方向垂直。<br>2.边缘方向：与边缘法线方向垂直，是目标边界的切线方向。<br>3.边缘位置：边缘所在的坐标位置。<br>4.边缘强度：沿边缘法线方向图像局部变化强度的量度。<br>（因为我比较渣，还不会用公式编辑器，所以就手写拍照了<br><img src="https://note.youdao.com/yws/api/personal/file/WEBc85d0d7063f38e477248efb3f66b17cb?method=getImage&amp;version=11&amp;cstk=ygdDwOL6" alt=""></p>
<h3 id="实现样例"><a href="#实现样例" class="headerlink" title="实现样例"></a>实现样例</h3><p>MATLAB在边缘检测方面常用的几种算子有：Roberts,Sobel,Prewitt,Laplacian和Canny等。通过调用edge函数可以十分方便地实现对图像的边缘检测。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">clear all;</span><br><span class="line">I=imread(&apos;circuit.tif&apos;);</span><br><span class="line">BW1=edge(I,&apos;prewitt&apos;);</span><br><span class="line">BW2=edge(I,&apos;canny&apos;);</span><br><span class="line">figure(&apos;name&apos;,&apos;灰度图像与边缘图像&apos;,&apos;numbertitle&apos;,&apos;off&apos;)</span><br><span class="line">subplot(131);</span><br><span class="line">imshow(I);</span><br><span class="line">title(&apos;灰度图像&apos;,&apos;fontsize&apos;,16)</span><br><span class="line">subplot(132);</span><br><span class="line">imshow(BW1);</span><br><span class="line">title(&apos;Prewitt算子检测边缘图像&apos;,&apos;fontsize&apos;,16)</span><br><span class="line">subplot(133);</span><br><span class="line">imshow(BW2);</span><br><span class="line">title(&apos;Canny算子检测边缘图像&apos;,&apos;fontsize&apos;,16)</span><br></pre></td></tr></table></figure></p>
<p>如下图，可以看出Prewitt和Canny算子对图像边缘均有较好的提取效果<br><img src="https://note.youdao.com/yws/api/personal/file/WEBd900b6fd7e510a3f3a82520175482576?method=getImage&amp;version=12&amp;cstk=ygdDwOL6" alt=""></p>
<h2 id="边缘检测–LVQ神经网络的原理与方法"><a href="#边缘检测–LVQ神经网络的原理与方法" class="headerlink" title="边缘检测–LVQ神经网络的原理与方法"></a>边缘检测–LVQ神经网络的原理与方法</h2><p>首先，教师信号的获取是先通过Sobel算子对样本图像进行处理得到图像的边缘，再经过人工筛选的方法，去除由于噪声引起的虚假边缘而得到的。作为LVQ神经网络输入的三个特征向量分别是中值特征向量，方向性信息特征向量，Krisch算子方向特征向量。由着三个特征向量，经过训练，可以有效提升边缘识别的精确度。</p>
<h4 id="第一步：载入图像，进行灰度处理"><a href="#第一步：载入图像，进行灰度处理" class="headerlink" title="第一步：载入图像，进行灰度处理"></a>第一步：载入图像，进行灰度处理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I0=imread(&apos;载入图像名称，需放在同一目录底&apos;);</span><br><span class="line">&gt;&gt; I=rgb2gray(I0)；</span><br><span class="line">&gt;&gt; BW0=edge(I,&apos;sobel&apos;);</span><br></pre></td></tr></table></figure>
<h4 id="计算特征向量（关键点），首先需将图像数据格式转换为double或single格式才能参与MATLAB运算；其次，为提高运行速度，考虑优化Krisch算子模板，转化为矩阵运算。"><a href="#计算特征向量（关键点），首先需将图像数据格式转换为double或single格式才能参与MATLAB运算；其次，为提高运行速度，考虑优化Krisch算子模板，转化为矩阵运算。" class="headerlink" title="计算特征向量（关键点），首先需将图像数据格式转换为double或single格式才能参与MATLAB运算；其次，为提高运行速度，考虑优化Krisch算子模板，转化为矩阵运算。"></a>计算特征向量（关键点），首先需将图像数据格式转换为double或single格式才能参与MATLAB运算；其次，为提高运行速度，考虑优化Krisch算子模板，转化为矩阵运算。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"> [m,n]=size(I);</span><br><span class="line">&gt;&gt; BW=BW0(2:m-1,2:n-1);</span><br><span class="line">&gt;&gt; [row_1,col_1]=find(BW==1);</span><br><span class="line">&gt;&gt; Len_1=length(row_1);</span><br><span class="line">&gt;&gt; N1=100;</span><br><span class="line">&gt;&gt; choose_1=unidrnd(Len_1,N1,1);</span><br><span class="line">&gt;&gt; [row_0,col_0]=find(BW==0);</span><br><span class="line">&gt;&gt; Len_0=length(row_0);</span><br><span class="line">&gt;&gt; N0=100;</span><br><span class="line">&gt;&gt; choose_0=unidrnd(Len_0,N0,1);</span><br><span class="line">&gt;&gt; M_I=zeros((m-2)*(n-2),1);</span><br><span class="line">&gt;&gt; I_theta=zeros((m-2)*(n-2),1);</span><br><span class="line">&gt;&gt; Krisch=zeros((m-2)*(n-2),1);</span><br><span class="line">&gt;&gt; KH=[5,-3,-3,5,0,-3,5,-3,-3;</span><br><span class="line">5,5,-3,5,0,-3,-3,-3,-3;</span><br><span class="line">5,5,5,-3,0,-3,-3,-3,-3;</span><br><span class="line">-3,5,5,-3,0,5,-3,-3,-3;</span><br><span class="line">-3,-3,5,-3,0,5,-3,-3,5;</span><br><span class="line">-3,-3,-3,-3,0,5,-3,5,5;</span><br><span class="line">-3,-3,-3,-3,0,-3,5,5,5;</span><br><span class="line">-3,-3,-3,5,0,-3,5,5,-3];</span><br><span class="line"></span><br><span class="line">&gt;&gt; for i=1:(m-2)*(n-2)</span><br><span class="line">if i&lt;=Len_1</span><br><span class="line">I_L=double(I(row_1(i):row_1(i)+2,col_1(i):col_1(i)+2));</span><br><span class="line">M_I(i)=median(I_L(:));</span><br><span class="line">D_theta=[sum(I_L([8,7,4,1]))-sum(I_L([2,3,6,9]));</span><br><span class="line">sum(I_L([7,4,1,2]))-sum(I_L([3,6,9,8]));</span><br><span class="line">sum(I_L([4,1,2,3]))-sum(I_L([6,9,8,7]));</span><br><span class="line">sum(I_L([1,2,3,6]))-sum(I_L([9,8,7,4]))];</span><br><span class="line">I_theta(i)=max(abs(D_theta))-min(abs(D_theta));</span><br><span class="line">qK=KH*I_L(:);</span><br><span class="line">Krisch(i)=max(abs(qK))-min(abs(qK));</span><br><span class="line">else</span><br><span class="line">I_L=double(I(row_0(i-Len_1):row_0(i-Len_1)+2,col_0(i-Len_1):col_0(i-Len_1)+2));</span><br><span class="line">M_I(i)=median(I_L(:));</span><br><span class="line">D_theta=[sum(I_L([8,7,4,1]))-sum(I_L([2,3,6,9]));</span><br><span class="line">sum(I_L([7,4,1,2]))-sum(I_L([3,6,9,8]));</span><br><span class="line">sum(I_L([4,1,2,3]))-sum(I_L([6,9,8,7]));</span><br><span class="line">sum(I_L([1,2,3,6]))-sum(I_L([9,8,7,4]))];</span><br><span class="line">I_theta(i)=max(abs(D_theta))-min(abs(D_theta));</span><br><span class="line">qK=KH*I_L(:);</span><br><span class="line">Krisch(i)=max(abs(qK))-min(abs(qK));</span><br><span class="line">end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="生成神经网络训练数据集，对神经网络进行训练，通过随机抽取边缘点与非边缘点对LVQ进行训练，完成后可得到各点计算得到的特征向量（那三个）来判断是否是边缘点，以此优化。"><a href="#生成神经网络训练数据集，对神经网络进行训练，通过随机抽取边缘点与非边缘点对LVQ进行训练，完成后可得到各点计算得到的特征向量（那三个）来判断是否是边缘点，以此优化。" class="headerlink" title="生成神经网络训练数据集，对神经网络进行训练，通过随机抽取边缘点与非边缘点对LVQ进行训练，完成后可得到各点计算得到的特征向量（那三个）来判断是否是边缘点，以此优化。"></a>生成神经网络训练数据集，对神经网络进行训练，通过随机抽取边缘点与非边缘点对LVQ进行训练，完成后可得到各点计算得到的特征向量（那三个）来判断是否是边缘点，以此优化。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> muntrain=[choose_1;choose_0];</span><br><span class="line">&gt;&gt;P_train=[M_I(muntrain)&apos;;I_theta(muntrain)&apos;;Krisch(muntrain)&apos;];</span><br><span class="line">&gt;&gt; Tc_train=[ones(1,N1),2*ones(1,N0)];</span><br><span class="line">&gt;&gt; T_train=ind2vec(Tc_train);</span><br><span class="line">&gt;&gt; rate=&#123;0.5,0.5&#125;;</span><br><span class="line">&gt;&gt; net=newlvq(minmax(P_train),20,cell2mat(rate),0.01,&apos;learnlv1&apos;);</span><br><span class="line">&gt;&gt; net.trainParam.epochs=100;</span><br><span class="line">&gt;&gt; net.trainParam.goal=0.001;</span><br><span class="line">&gt;&gt; net.trainParam.lr=0.1;</span><br><span class="line">&gt;&gt; net=train(net,P_train,T_train);</span><br><span class="line">&gt;&gt; P_test=[M_I&apos;;I_theta&apos;;Krisch&apos;];</span><br><span class="line">&gt;&gt; T_sim=sim(net,P_test);</span><br><span class="line">&gt;&gt; Tc_sim=vec2ind(T_sim);</span><br><span class="line">&gt;&gt; BW1=zeros(m,n);</span><br><span class="line">&gt;&gt; nI=find(Tc_sim==1);</span><br><span class="line">&gt;&gt; nI1=find(nI&lt;=Len_1);</span><br><span class="line">&gt;&gt; BW1(col_1(nI(nI1))*m+row_1(nI(nI1))+1)=1;</span><br><span class="line">&gt;&gt; nI1=find(nI&gt;Len_1);</span><br><span class="line">&gt;&gt; BW1(col_0(nI(nI1)-Len_1)*m+row_0(nI(nI1)-Len_1)+1)=1;</span><br></pre></td></tr></table></figure>
<h4 id="最后，显示图像，以示对比。"><a href="#最后，显示图像，以示对比。" class="headerlink" title="最后，显示图像，以示对比。"></a>最后，显示图像，以示对比。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> figure(&apos;name&apos;,&apos;灰度图像与边缘图像&apos;,&apos;numbertitle&apos;,&apos;off&apos;)</span><br><span class="line">&gt;&gt; subplot(131);</span><br><span class="line">&gt;&gt; imshow(I);</span><br><span class="line">&gt;&gt; title(&apos;灰度图像&apos;,&apos;fontsize&apos;,16)</span><br><span class="line">&gt;&gt; subplot(132);</span><br><span class="line">&gt;&gt; imshow(BW);</span><br><span class="line">&gt;&gt; title(&apos;Sobel检测边缘图像&apos;,&apos;fontsize&apos;,16);</span><br><span class="line">&gt;&gt; subplot(133);</span><br><span class="line">&gt;&gt; imshow(BW1);</span><br><span class="line">&gt;&gt; title(&apos;神经网络检测边缘图像&apos;,&apos;fontsize&apos;,16);</span><br></pre></td></tr></table></figure>
<p>效果展示<br><img src="https://note.youdao.com/yws/api/personal/file/WEB6cca8606aae714624754aad785f6d64f?method=getImage&amp;version=13&amp;cstk=ygdDwOL6" alt=""></p>
<h2 id="人脸识别朝向问题"><a href="#人脸识别朝向问题" class="headerlink" title="人脸识别朝向问题"></a>人脸识别朝向问题</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/07/数字图像边缘检测/" data-id="cjzf95x8k00039kvqulny643h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-实验/一个简单的RPG游戏体验" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/06/实验/一个简单的RPG游戏体验/" class="article-date">
  <time datetime="2019-08-06T08:03:40.000Z" itemprop="datePublished">2019-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/06/实验/一个简单的RPG游戏体验/">一个简单的RPG游戏体验（后期会补足</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一些说明：这是C-课程的一次实验（程序还不完善，人物未完全实现（第一次用Markdown编写，用法还不太熟悉，界面美观性有缺"><a href="#一些说明：这是C-课程的一次实验（程序还不完善，人物未完全实现（第一次用Markdown编写，用法还不太熟悉，界面美观性有缺" class="headerlink" title="一些说明：这是C++课程的一次实验（程序还不完善，人物未完全实现（第一次用Markdown编写，用法还不太熟悉，界面美观性有缺"></a>一些说明：这是C++课程的一次实验（程序还不完善，人物未完全实现（第一次用Markdown编写，用法还不太熟悉，界面美观性有缺</h3><h4 id="VS2017"><a href="#VS2017" class="headerlink" title="VS2017"></a>VS2017</h4><h5 id="基本玩法："><a href="#基本玩法：" class="headerlink" title="基本玩法："></a>基本玩法：</h5><p>1.创建角色，选择职业（这里暂时只实现了swordsman的代码，所以暂时只能选swordsman）<br>2.默认你的对手是什么；<br>3.展示你和你对手的状态，包括血量和魔法值（本题用了容器写了一个背包，里面放置你拥有的治疗药水和魔法药水）<br>4.战斗，你可以选择普攻，特殊攻击（有概率被闪避）或者使用药水来恢复自己，对手也一样，这是一个回合。进攻成功可以获得经验然后升级。<br>5.直至一方死亡，若你死亡，就game over，如果对手死亡，你可以获得他背包中剩下的物品，然后迎接下一位对手。<br>6.重复以上步骤。</p>
<h4 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h4><p><a href="#1.1">container.h</a><br><a href="#2.1">player.h</a><br><a href="#3.1">swordsman.h</a></p>
<h4 id="源文件"><a href="#源文件" class="headerlink" title="源文件"></a>源文件</h4><p><a href="#1.2">container.cpp</a><br><a href="#2.2">player.cpp</a><br><a href="#3.2">swordsman.cpp</a><br><a href="#0">main.cpp</a></p>
<h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><h2 id="1.1">contain.h</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// The so-called inventory of a player in RPG games</span><br><span class="line">// contains two items, heal and magic water</span><br><span class="line"></span><br><span class="line">#ifndef _CONTAINER	// Conditional compilation</span><br><span class="line">#define _CONTAINER</span><br><span class="line"></span><br><span class="line">class container		// Inventory</span><br><span class="line">&#123;</span><br><span class="line">protected:</span><br><span class="line">	int numOfHeal;			// number of heal</span><br><span class="line">	int numOfMW;			// number of magic water</span><br><span class="line">public:</span><br><span class="line">	container();			// constuctor</span><br><span class="line">	void set(int heal_n, int mw_n);	// set the items numbers</span><br><span class="line">	int nOfHeal();			// get the number of heal</span><br><span class="line">	int nOfMW();			// get the number of magic water</span><br><span class="line">	void display();			// display the items;</span><br><span class="line">	bool useHeal();			// use heal</span><br><span class="line">	bool useMW();			// use magic water</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<h2 id="2.1">player.h</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">// The base class of player</span><br><span class="line">// including the general properties and methods related to a character</span><br><span class="line"></span><br><span class="line">#ifndef _PLAYER</span><br><span class="line">#define _PLAYER</span><br><span class="line"></span><br><span class="line">#include &lt;iomanip&gt;		// use for setting field width</span><br><span class="line">#include &lt;time.h&gt;	  // use for generating random factor</span><br><span class="line">#include&lt;string&gt;</span><br><span class="line">#include &quot;container.h&quot;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">enum job &#123;sw, ar, mg&#125;;	/* define 3 jobs by enumerate type</span><br><span class="line">							   sword man, archer, mage */</span><br><span class="line">class player</span><br><span class="line">&#123;</span><br><span class="line">	friend void showinfo(player &amp;p1, player &amp;p2);</span><br><span class="line">	friend class swordsman;</span><br><span class="line"></span><br><span class="line">protected:</span><br><span class="line">	int HP, HPmax, MP, MPmax, AP, DP, speed, EXP, LV;</span><br><span class="line">	// General properties of all characters</span><br><span class="line">	string name;	// character name</span><br><span class="line">	job role;		/* character&apos;s job, one of swordman, archer and mage,</span><br><span class="line">					   as defined by the enumerate type */</span><br><span class="line">	container bag;	// character&apos;s inventory</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">	virtual bool attack(player &amp;p)=0;	// normal attack</span><br><span class="line">	virtual bool specialatt(player &amp;p)=0;	//special attack</span><br><span class="line">	virtual void isLevelUp()=0;			// level up judgement</span><br><span class="line">	/* Attention!</span><br><span class="line">	These three methods are called &quot;Pure virtual functions&quot;.</span><br><span class="line">	They have only declaration, but no definition.</span><br><span class="line">	The class with pure virtual functions are called &quot;Abstract class&quot;, which can only be used to inherited, but not to constructor objects. </span><br><span class="line">	The detailed definition of these pure virtual functions will be given in subclasses. */</span><br><span class="line"></span><br><span class="line">	player() &#123;&#125;</span><br><span class="line">	void reFill();		// character&apos;s HP and MP resume</span><br><span class="line">	bool death();		// report whether character is dead</span><br><span class="line">	void isDead();		// check whether character is dead</span><br><span class="line">	bool useHeal();		// consume heal, irrelevant to job</span><br><span class="line">	bool useMW();		// consume magic water, irrelevant to job</span><br><span class="line">	void transfer(player &amp;p);	// possess opponent&apos;s items after victory</span><br><span class="line">	void showRole();	// display character&apos;s job</span><br><span class="line">	</span><br><span class="line">private:</span><br><span class="line">	bool playerdeath;			// whether character is dead, doesn&apos;t need to be accessed or inherited</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<h2 id="3.1">swordsman.h</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// Derived from base class player</span><br><span class="line">// For the job Swordsman</span><br><span class="line"></span><br><span class="line">#include &quot;player.h&quot;</span><br><span class="line">class swordsman : public player	// subclass swordsman publicly inherited from base player</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">	swordsman(int lv_in=1, string name_in=&quot;Not Given&quot;);	</span><br><span class="line">		// constructor with default level of 1 and name of &quot;Not given&quot;</span><br><span class="line">	void isLevelUp();</span><br><span class="line">	bool attack (player &amp;p);</span><br><span class="line">	bool specialatt(player &amp;p);</span><br><span class="line">		/* These three are derived from the pure virtual functions of base class</span><br><span class="line">		   The definition of them will be given in this subclass. */</span><br><span class="line">	void AI(player &amp;p);				// Computer opponent</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="1.2">container.cpp</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">// default constructor initialise the inventory as empty</span><br><span class="line">#include&quot;container.h&quot;</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">container::container()</span><br><span class="line">&#123;</span><br><span class="line">	set(0,0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// set the item numbers</span><br><span class="line">void container::set(int heal_n, int mw_n)</span><br><span class="line">&#123;</span><br><span class="line">	numOfHeal=heal_n;</span><br><span class="line">	numOfMW=mw_n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// get the number of heal</span><br><span class="line">int container::nOfHeal()</span><br><span class="line">&#123;</span><br><span class="line">	return numOfHeal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// get the number of magic water</span><br><span class="line">int container::nOfMW()</span><br><span class="line">&#123;</span><br><span class="line">	return numOfMW;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// display the items;</span><br><span class="line">void container::display()</span><br><span class="line">&#123;</span><br><span class="line">	cout&lt;&lt;&quot;Your bag contains: &quot;&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;Heal(HP+100): &quot;&lt;&lt;numOfHeal&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;Magic Water (MP+80): &quot;&lt;&lt;numOfMW&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//use heal</span><br><span class="line">bool container::useHeal()</span><br><span class="line">&#123;</span><br><span class="line">	numOfHeal--;</span><br><span class="line">	return 1;		// use heal successfully</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//use magic water</span><br><span class="line">bool container::useMW()</span><br><span class="line">&#123;</span><br><span class="line">	numOfMW--;</span><br><span class="line">	return 1;		// use magic water successfully</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2.2">player.cpp</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">// character&apos;s HP and MP resume</span><br><span class="line">#include&quot;player.h&quot;</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">void player::reFill()</span><br><span class="line">&#123;</span><br><span class="line">	HP=HPmax;		// HP and MP fully recovered</span><br><span class="line">	MP=MPmax;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// report whether character is dead</span><br><span class="line">bool player::death()</span><br><span class="line">&#123;</span><br><span class="line">	return playerdeath;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// check whether character is dead</span><br><span class="line">void player::isDead()</span><br><span class="line">&#123;</span><br><span class="line">	if(HP&lt;=0)		// HP less than 0, character is dead</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot; is Dead.&quot; &lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		playerdeath=1;	// give the label of death value 1</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// consume heal, irrelevant to job</span><br><span class="line">bool player::useHeal()</span><br><span class="line">&#123;</span><br><span class="line">	if(bag.nOfHeal()&gt;0)</span><br><span class="line">	&#123;</span><br><span class="line">		HP=HP+100;</span><br><span class="line">		if(HP&gt;HPmax)		// HP cannot be larger than maximum value</span><br><span class="line">			HP=HPmax;		// so assign it to HPmax, if necessary</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot; used Heal, HP increased by 100.&quot;&lt;&lt;endl;</span><br><span class="line">		bag.useHeal();		// use heal</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		return 1;	// usage of heal succeed</span><br><span class="line">	&#125;</span><br><span class="line">	else				// If no more heal in bag, cannot use</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;&quot;Sorry, you don&apos;t have heal to use.&quot;&lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		return 0;	// usage of heal failed</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// consume magic water, irrelevant to job</span><br><span class="line">bool player::useMW()</span><br><span class="line">&#123;</span><br><span class="line">	if(bag.nOfMW()&gt;0)</span><br><span class="line">	&#123;</span><br><span class="line">		MP=MP+100;</span><br><span class="line">		if(MP&gt;MPmax)</span><br><span class="line">			MP=MPmax;</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot; used Magic Water, MP increased by 100.&quot;&lt;&lt;endl;</span><br><span class="line">		bag.useMW();</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		return 1;	// usage of magic water succeed</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;&quot;Sorry, you don&apos;t have magic water to use.&quot;&lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		return 0;	// usage of magic water failed</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// possess opponent&apos;s items after victory</span><br><span class="line">void player::transfer(player &amp;p)</span><br><span class="line">&#123;</span><br><span class="line">	cout&lt;&lt;name&lt;&lt;&quot; got&quot;&lt;&lt;p.bag.nOfHeal()&lt;&lt;&quot; Heal, and &quot;&lt;&lt;p.bag.nOfMW()&lt;&lt;&quot; Magic Water.&quot;&lt;&lt;endl;</span><br><span class="line">	system(&quot;pause&quot;);</span><br><span class="line">	//bag.nOfHeal += p.bag.nOfHeal();    </span><br><span class="line">	//bag.nOfMW += p.bag.nOfMW();</span><br><span class="line">	// set the character&apos;s bag, get opponent&apos;s items</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// display character&apos;s job</span><br><span class="line">void player::showRole()</span><br><span class="line">&#123;</span><br><span class="line">	switch(role)</span><br><span class="line">	&#123;</span><br><span class="line">	case sw:</span><br><span class="line">		cout&lt;&lt;&quot;Swordsman&quot;;</span><br><span class="line">		break;</span><br><span class="line">	case ar:</span><br><span class="line">		cout&lt;&lt;&quot;Archer&quot;;</span><br><span class="line">		break;</span><br><span class="line">	case mg:</span><br><span class="line">		cout&lt;&lt;&quot;Mage&quot;;</span><br><span class="line">		break;</span><br><span class="line">	default:</span><br><span class="line">		break;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// display character&apos;s job</span><br><span class="line">void showinfo(player &amp;p1,player &amp;p2)</span><br><span class="line">&#123;</span><br><span class="line">	system(&quot;cls&quot;);</span><br><span class="line">	cout&lt;&lt;&quot;##############################################################&quot;&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;# Player&quot;&lt;&lt;setw(10)&lt;&lt;p1.name&lt;&lt;&quot;   LV. &quot;&lt;&lt;setw(3) &lt;&lt;p1.LV</span><br><span class="line">		&lt;&lt;&quot;  # Opponent&quot;&lt;&lt;setw(10)&lt;&lt;p2.name&lt;&lt;&quot;   LV. &quot;&lt;&lt;setw(3) &lt;&lt;p2.LV&lt;&lt;&quot; #&quot;&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;# HP &quot;&lt;&lt;setw(3)&lt;&lt;(p1.HP&lt;=999?p1.HP:999)&lt;&lt;&apos;/&apos;&lt;&lt;setw(3)&lt;&lt;(p1.HPmax&lt;=999?p1.HPmax:999)</span><br><span class="line">		&lt;&lt;&quot; | MP &quot;&lt;&lt;setw(3)&lt;&lt;(p1.MP&lt;=999?p1.MP:999)&lt;&lt;&apos;/&apos;&lt;&lt;setw(3)&lt;&lt;(p1.MPmax&lt;=999?p1.MPmax:999)</span><br><span class="line">		&lt;&lt;&quot;     # HP &quot;&lt;&lt;setw(3)&lt;&lt;(p2.HP&lt;=999?p2.HP:999)&lt;&lt;&apos;/&apos;&lt;&lt;setw(3)&lt;&lt;(p2.HPmax&lt;=999?p2.HPmax:999)</span><br><span class="line">		&lt;&lt;&quot; | MP &quot;&lt;&lt;setw(3)&lt;&lt;(p2.MP&lt;=999?p2.MP:999)&lt;&lt;&apos;/&apos;&lt;&lt;setw(3)&lt;&lt;(p2.MPmax&lt;=999?p2.MPmax:999)&lt;&lt;&quot;      #&quot;&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;# AP &quot;&lt;&lt;setw(3)&lt;&lt;(p1.AP&lt;=999?p1.AP:999)</span><br><span class="line">		&lt;&lt;&quot; | DP &quot;&lt;&lt;setw(3)&lt;&lt;(p1.DP&lt;=999?p1.DP:999)</span><br><span class="line">		&lt;&lt;&quot; | speed &quot;&lt;&lt;setw(3)&lt;&lt;(p1.speed&lt;=999?p1.speed:999)</span><br><span class="line">		&lt;&lt;&quot; # AP &quot;&lt;&lt;setw(3)&lt;&lt;(p2.AP&lt;=999?p2.AP:999)</span><br><span class="line">		&lt;&lt;&quot; | DP &quot;&lt;&lt;setw(3)&lt;&lt;(p2.DP&lt;=999?p2.DP:999)</span><br><span class="line">		&lt;&lt;&quot; | speed &quot;&lt;&lt;setw(3)&lt;&lt;(p2.speed&lt;=999?p2.speed:999)&lt;&lt;&quot;  #&quot;&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;# EXP&quot;&lt;&lt;setw(7)&lt;&lt;p1.EXP&lt;&lt;&quot; Job: &quot;&lt;&lt;setw(7);</span><br><span class="line">	p1.showRole();</span><br><span class="line">	cout&lt;&lt;&quot;   # EXP&quot;&lt;&lt;setw(7)&lt;&lt;p2.EXP&lt;&lt;&quot; Job: &quot;&lt;&lt;setw(7);</span><br><span class="line">	p2.showRole();</span><br><span class="line">	cout&lt;&lt;&quot;    #&quot;&lt;&lt;endl;</span><br><span class="line">	cout&lt;&lt;&quot;--------------------------------------------------------------&quot;&lt;&lt;endl;</span><br><span class="line">	p1.bag.display();</span><br><span class="line">	cout&lt;&lt;&quot;##############################################################&quot;&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3.2">swordsman.cpp</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">// constructor. default values don&apos;t need to be repeated here</span><br><span class="line">#include&quot;swordsman.h&quot;</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">swordsman::swordsman(int lv_in, string name_in)</span><br><span class="line">&#123;</span><br><span class="line">	role=sw;	// enumerate type of job</span><br><span class="line">	LV=lv_in;</span><br><span class="line">	name=name_in;</span><br><span class="line">	</span><br><span class="line">	// Initialising the character&apos;s properties, based on his level</span><br><span class="line">	HPmax=150+8*(LV-1);		// HP increases 8 point2 per level</span><br><span class="line">	HP=HPmax;</span><br><span class="line">	MPmax=75+2*(LV-1);		// MP increases 2 points per level</span><br><span class="line">	MP=MPmax;</span><br><span class="line">	AP=25+4*(LV-1);			// AP increases 4 points per level</span><br><span class="line">	DP=25+4*(LV-1);			// DP increases 4 points per level</span><br><span class="line">	speed=25+2*(LV-1);		// speed increases 2 points per level</span><br><span class="line">	</span><br><span class="line">	playerdeath=0;</span><br><span class="line">	EXP=LV*LV*75;</span><br><span class="line">	bag.set(lv_in, lv_in);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void swordsman::isLevelUp()</span><br><span class="line">&#123;</span><br><span class="line">	if(EXP&gt;=LV*LV*75)</span><br><span class="line">	&#123;</span><br><span class="line">		LV++;</span><br><span class="line">		AP+=4;</span><br><span class="line">		DP+=4;</span><br><span class="line">		HPmax+=8;</span><br><span class="line">		MPmax+=2;</span><br><span class="line">		speed+=2;</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot; Level UP!&quot;&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;&quot;HP improved 8 points to &quot;&lt;&lt;HPmax&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;&quot;MP improved 2 points to &quot;&lt;&lt;MPmax&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;&quot;Speed improved 2 points to &quot;&lt;&lt;speed&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;&quot;AP improved 4 points to &quot;&lt;&lt;AP&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;&quot;DP improved 5 points to &quot;&lt;&lt;DP&lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		isLevelUp();	// recursively call this function, so the character can level up multiple times if got enough exp</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bool swordsman::attack(player &amp;p)</span><br><span class="line">&#123;</span><br><span class="line">	double HPtemp=0;		// opponent&apos;s HP decrement</span><br><span class="line">	double EXPtemp=0;		// player obtained exp</span><br><span class="line">	double hit=1;			// attach factor, probably give critical attack</span><br><span class="line">	srand((unsigned)time(NULL));		// generating random seed based on system time</span><br><span class="line"></span><br><span class="line">	// If speed greater than opponent, you have some possibility to do double attack</span><br><span class="line">	if ((speed&gt;p.speed) &amp;&amp; (rand()%100&lt;(speed-p.speed)))		// rand()%100 means generates a number no greater than 100</span><br><span class="line">	&#123;</span><br><span class="line">		HPtemp=(int)((1.0*AP/p.DP)*AP*5/(rand()%4+10));		// opponent&apos;s HP decrement calculated based their AP/DP, and uncertain chance</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot;&apos;s quick strike hit &quot;&lt;&lt;p.name&lt;&lt;&quot;, &quot;&lt;&lt;p.name&lt;&lt;&quot;&apos;s HP decreased &quot;&lt;&lt;HPtemp&lt;&lt;endl;</span><br><span class="line">		p.HP=int(p.HP-HPtemp);</span><br><span class="line">		EXPtemp=(int)(HPtemp*1.2);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// If speed smaller than opponent, the opponent has possibility to evade</span><br><span class="line">	if ((speed&lt;p.speed) &amp;&amp; (rand()%50&lt;1))</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot;&apos;s attack has been evaded by &quot;&lt;&lt;p.name&lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		return 1;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 10% chance give critical attack</span><br><span class="line">	if (rand()%100&lt;=10)</span><br><span class="line">	&#123;</span><br><span class="line">		hit=1.5;</span><br><span class="line">		cout&lt;&lt;&quot;Critical attack: &quot;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// Normal attack</span><br><span class="line">	HPtemp=(int)((1.0*AP/p.DP)*AP*5/(rand()%4+10));</span><br><span class="line">	cout&lt;&lt;name&lt;&lt;&quot; uses bash, &quot;&lt;&lt;p.name&lt;&lt;&quot;&apos;s HP decreases &quot;&lt;&lt;HPtemp&lt;&lt;endl;</span><br><span class="line">	EXPtemp=(int)(EXPtemp+HPtemp*1.2);</span><br><span class="line">	p.HP=(int)(p.HP-HPtemp);</span><br><span class="line">	cout&lt;&lt;name&lt;&lt;&quot; obtained &quot;&lt;&lt;EXPtemp&lt;&lt;&quot; experience.&quot;&lt;&lt;endl;</span><br><span class="line">	EXP=(int)(EXP+EXPtemp);</span><br><span class="line">	system(&quot;pause&quot;);</span><br><span class="line">	return 1;		// Attack success</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bool swordsman::specialatt(player &amp;p)</span><br><span class="line">&#123;</span><br><span class="line">	if(MP&lt;40)</span><br><span class="line">	&#123;</span><br><span class="line">		cout&lt;&lt;&quot;You don&apos;t have enough magic points!&quot;&lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		return 0;		// Attack failed</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		MP-=40;			// consume 40 MP to do special attack</span><br><span class="line">		</span><br><span class="line">		//10% chance opponent evades</span><br><span class="line">		if(rand()%100&lt;=10)</span><br><span class="line">		&#123;</span><br><span class="line">			cout&lt;&lt;name&lt;&lt;&quot;&apos;s leap attack has been evaded by &quot;&lt;&lt;p.name&lt;&lt;endl;</span><br><span class="line">			system(&quot;pause&quot;);</span><br><span class="line">			return 1;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		double HPtemp=0;		</span><br><span class="line">		double EXPtemp=0;		</span><br><span class="line">		//double hit=1;			</span><br><span class="line">		//srand(time(NULL));		</span><br><span class="line">		HPtemp=(int)(AP*1.2+20);		// not related to opponent&apos;s DP</span><br><span class="line">		EXPtemp=(int)(HPtemp*1.5);		// special attack provides more experience</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot; uses leap attack, &quot;&lt;&lt;p.name&lt;&lt;&quot;&apos;s HP decreases &quot;&lt;&lt;HPtemp&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;name&lt;&lt;&quot; obtained &quot;&lt;&lt;EXPtemp&lt;&lt;&quot; experience.&quot;&lt;&lt;endl;</span><br><span class="line">		p.HP=(int)(p.HP-HPtemp);</span><br><span class="line">		EXP=(int)(EXP+EXPtemp);</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	return 1;	// special attack succeed</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Computer opponent</span><br><span class="line">void swordsman::AI(player &amp;p)</span><br><span class="line">&#123;</span><br><span class="line">	if ((HP&lt;(int)((1.0*p.AP/DP)*p.AP*1.5))&amp;&amp;(HP+100&lt;=1.1*HPmax)&amp;&amp;(bag.nOfHeal()&gt;0)&amp;&amp;(HP&gt;(int)((1.0*p.AP/DP)*p.AP*0.5)))</span><br><span class="line">		// AI&apos;s HP cannot sustain 3 rounds &amp;&amp; not too lavish &amp;&amp; still has heal &amp;&amp; won&apos;t be killed in next round</span><br><span class="line">	&#123;</span><br><span class="line">		useHeal();</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		if(MP&gt;=40 &amp;&amp; HP&gt;0.5*HPmax &amp;&amp; rand()%100&lt;=30)</span><br><span class="line">			// AI has enough MP, it has 30% to make special attack</span><br><span class="line">		&#123;</span><br><span class="line">			specialatt(p);</span><br><span class="line">			p.isDead();		// check whether player is dead</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			if (MP&lt;40 &amp;&amp; HP&gt;0.5*HPmax &amp;&amp; bag.nOfMW())</span><br><span class="line">				// Not enough MP &amp;&amp; HP is safe &amp;&amp; still has magic water</span><br><span class="line">			&#123;</span><br><span class="line">				useMW();</span><br><span class="line">			&#125;</span><br><span class="line">			else</span><br><span class="line">			&#123;</span><br><span class="line">				attack(p);	// normal attack</span><br><span class="line">				p.isDead();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0">main.cpp</h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">// main function for the RPG style game</span><br><span class="line"></span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include&quot;container.h&quot;</span><br><span class="line">#include &quot;swordsman.h&quot;</span><br><span class="line">#include&quot;player.h&quot;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	string tempName;</span><br><span class="line">	bool success=0;		//flag for storing whether operation is successful</span><br><span class="line">	cout &lt;&lt;&quot;Please input player&apos;s name: &quot;;</span><br><span class="line">	cin &gt;&gt;tempName;		// get player&apos;s name from keyboard input</span><br><span class="line">	swordsman s1;</span><br><span class="line">	player *human=&amp;s1;		// use pointer of base class, convenience for polymorphism</span><br><span class="line">	int tempJob;		// temp choice for job selection</span><br><span class="line">	do</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt;&quot;Please choose a job: 1 Swordsman, 2 Archer, 3 Mage&quot;&lt;&lt;endl;</span><br><span class="line">		cin&gt;&gt;tempJob;</span><br><span class="line">		system(&quot;cls&quot;);		// clear the screen</span><br><span class="line">		switch(tempJob)</span><br><span class="line">		&#123;</span><br><span class="line">		case 1:</span><br><span class="line">			human=new swordsman(1,tempName);	// create the character with user inputted name and job</span><br><span class="line">			success=1;		// operation succeed</span><br><span class="line">			break;</span><br><span class="line">		default:</span><br><span class="line">			break;				// In this case, success=0, character creation failed</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;while(success!=1);		// so the loop will ask user to re-create a character</span><br><span class="line"></span><br><span class="line">	int tempCom;			// temp command inputted by user</span><br><span class="line">	int nOpp=0;				// the Nth opponent</span><br><span class="line">	for(int i=1;nOpp&lt;5;i+=2)	// i is opponent&apos;s level</span><br><span class="line">	&#123;</span><br><span class="line">		nOpp++;</span><br><span class="line">		system(&quot;cls&quot;);</span><br><span class="line">		cout&lt;&lt;&quot;STAGE&quot; &lt;&lt;nOpp&lt;&lt;endl;</span><br><span class="line">		cout&lt;&lt;&quot;Your opponent, a Level &quot;&lt;&lt;i&lt;&lt;&quot; Swordsman.&quot;&lt;&lt;endl;</span><br><span class="line">		system(&quot;pause&quot;);</span><br><span class="line">		swordsman enemy(i, &quot;Warrior&quot;);	// Initialise an opponent, level i, name &quot;Junior&quot;</span><br><span class="line">		human-&gt;reFill();				// get HP/MP refill before start fight</span><br><span class="line">		while(!human-&gt;death() &amp;&amp; !enemy.death())	// no died</span><br><span class="line">		&#123;</span><br><span class="line">			success=0;</span><br><span class="line">			while (success!=1)</span><br><span class="line">			&#123;</span><br><span class="line">				showinfo(*human,enemy);				// show fighter&apos;s information</span><br><span class="line">				cout&lt;&lt;&quot;Please give command: &quot;&lt;&lt;endl;</span><br><span class="line">				cout&lt;&lt;&quot;1 Attack; 2 Special Attack; 3 Use Heal; 4 Use Magic Water; 0 Exit Game&quot;&lt;&lt;endl;</span><br><span class="line">				cin&gt;&gt;tempCom;</span><br><span class="line">				switch(tempCom)</span><br><span class="line">				&#123;</span><br><span class="line">				case 0:</span><br><span class="line">					cout&lt;&lt;&quot;Are you sure to exit? Y/N&quot;&lt;&lt;endl;</span><br><span class="line">					char temp;</span><br><span class="line">					cin&gt;&gt;temp;</span><br><span class="line">					if(temp==&apos;Y&apos;||temp==&apos;y&apos;)</span><br><span class="line">						return 0;</span><br><span class="line">					else</span><br><span class="line">						break;</span><br><span class="line">				case 1:</span><br><span class="line">					success=human-&gt;attack(enemy);</span><br><span class="line">					human-&gt;isLevelUp();</span><br><span class="line">					enemy.isDead();</span><br><span class="line">					break;</span><br><span class="line">				case 2:</span><br><span class="line">					success=human-&gt;specialatt(enemy);</span><br><span class="line">					human-&gt;isLevelUp();</span><br><span class="line">					enemy.isDead();</span><br><span class="line">					break;</span><br><span class="line">				case 3:</span><br><span class="line">					success=human-&gt;useHeal();</span><br><span class="line">					break;</span><br><span class="line">				case 4:</span><br><span class="line">					success=human-&gt;useMW();</span><br><span class="line">					break;</span><br><span class="line">				default:</span><br><span class="line">					break;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			if(!enemy.death())		// If AI still alive</span><br><span class="line">				enemy.AI(*human);</span><br><span class="line">			else							// AI died</span><br><span class="line">			&#123;</span><br><span class="line">				cout&lt;&lt;&quot;YOU WIN&quot;&lt;&lt;endl;</span><br><span class="line">				human-&gt;transfer(enemy);		// player got all AI&apos;s items</span><br><span class="line">			&#125;</span><br><span class="line">			if (human-&gt;death())</span><br><span class="line">			&#123;</span><br><span class="line">				system(&quot;cls&quot;);</span><br><span class="line">				cout&lt;&lt;endl&lt;&lt;setw(50)&lt;&lt;&quot;GAME OVER&quot;&lt;&lt;endl;</span><br><span class="line">				cout &lt;&lt; &quot;you are dead,you can choose try it again&quot; &lt;&lt; endl;   // player is dead, program is getting to its end, we can ?</span><br><span class="line">				system(&quot;pause&quot;);</span><br><span class="line">				return 0;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; &quot;Congratulations,you have won the game,you can choose try it again&quot; &lt;&lt; endl;	// You win, program is getting to its end, we can?</span><br><span class="line">	system(&quot;cls&quot;);</span><br><span class="line">	cout&lt;&lt;&quot;Congratulations! You defeated all opponents!!&quot;&lt;&lt;endl;</span><br><span class="line">	system(&quot;pause&quot;);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/06/实验/一个简单的RPG游戏体验/" data-id="cjzf95x9l00059kvqhcrbu1uh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-程序设计ACM/校onlinejudge整理（持续更新" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/06/程序设计ACM/校onlinejudge整理（持续更新/" class="article-date">
  <time datetime="2019-08-06T04:21:07.000Z" itemprop="datePublished">2019-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/06/程序设计ACM/校onlinejudge整理（持续更新/">校onlinejudge整理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##标签<br>[1]</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/06/程序设计ACM/校onlinejudge整理（持续更新/" data-id="cjzf95x9j00049kvqsh1tdrs9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/19/hello-world/" class="article-date">
  <time datetime="2018-10-19T15:19:46.038Z" itemprop="datePublished">2018-10-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/19/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/19/hello-world/" data-id="cjzf95x8d00009kvqfjo0zrtc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/08/17/反向传播算法原理及代码样例/">反向传播算法原理及代码样例</a>
          </li>
        
          <li>
            <a href="/2019/08/09/数字图像色彩分层提取/">数字图像提取</a>
          </li>
        
          <li>
            <a href="/2019/08/07/数字图像边缘检测/">图像识别（会步步深入，计划是完成人脸识别朝向，再之后可能会做复杂一点的人脸识别问题，会动态更新</a>
          </li>
        
          <li>
            <a href="/2019/08/06/实验/一个简单的RPG游戏体验/">一个简单的RPG游戏体验（后期会补足</a>
          </li>
        
          <li>
            <a href="/2019/08/06/程序设计ACM/校onlinejudge整理（持续更新/">校onlinejudge整理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 ShenQidetao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>